{"version":3,"sources":["../../out/fields/date-time.js"],"names":["Object","defineProperty","exports","value","maishu_wuzhui_1","require","dateTimeField","args","field","DateTimeField","validateRules","r","assign","headerStyle","textAlign","width","itemStyle","emptyText","ctrl","VALUE","get","str","element","Date","parse","err","set","toDateTimeString","placeholder","className","dataItem","cell","formatValue","BoundField","datetime","d","month","getMonth","length","date","getDate","hours","getHours","minutes","getMinutes","getFullYear"],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst maishu_wuzhui_1 = require(\"maishu-wuzhui\");\r\nfunction dateTimeField(args) {\r\n    let field = new DateTimeField(args);\r\n    let validateRules = {\r\n        validateRules: args.validateRules\r\n    };\r\n    let r = Object.assign(field, validateRules);\r\n    return r;\r\n}\r\nexports.dateTimeField = dateTimeField;\r\nclass DateTimeField extends maishu_wuzhui_1.BoundField {\r\n    constructor(args) {\r\n        super(Object.assign({\r\n            headerStyle: { textAlign: 'center', width: '160px' },\r\n            itemStyle: { textAlign: 'center', width: `160px` }\r\n        }, args));\r\n        this.emptyText = args.emptyText;\r\n    }\r\n    createControl() {\r\n        let ctrl = super.createControl();\r\n        let VALUE = \"value\";\r\n        Object.defineProperty(ctrl, VALUE, {\r\n            get() {\r\n                let str = ctrl.element.value;\r\n                let value;\r\n                try {\r\n                    value = new Date(Date.parse(str));\r\n                }\r\n                catch (err) {\r\n                }\r\n                return value;\r\n            },\r\n            set(value) {\r\n                let str = toDateTimeString(value);\r\n                ctrl.element.value = str;\r\n            }\r\n        });\r\n        if (this.emptyText)\r\n            ctrl.element.placeholder = this.emptyText;\r\n        ctrl.element.className = \"form-control\";\r\n        return ctrl;\r\n    }\r\n    createItemCell(dataItem) {\r\n        let cell = super.createItemCell(dataItem);\r\n        cell.formatValue = function (value) {\r\n            return toDateTimeString(value);\r\n        };\r\n        return cell;\r\n    }\r\n}\r\nfunction toDateTimeString(datetime) {\r\n    if (datetime == null)\r\n        return null;\r\n    if (typeof datetime == \"string\") {\r\n        datetime = new Date(datetime);\r\n    }\r\n    let d;\r\n    if (typeof datetime == 'number')\r\n        d = new Date(datetime);\r\n    else\r\n        d = datetime;\r\n    let month = `${d.getMonth() + 1}`;\r\n    month = month.length == 1 ? '0' + month : month;\r\n    let date = `${d.getDate()}`;\r\n    date = date.length == 1 ? '0' + date : date;\r\n    let hours = `${d.getHours()}`;\r\n    hours = hours.length == 1 ? '0' + hours : hours;\r\n    let minutes = `${d.getMinutes()}`;\r\n    minutes = minutes.length == 1 ? '0' + minutes : minutes;\r\n    return `${d.getFullYear()}-${month}-${date} ${hours}:${minutes}`;\r\n}\r\nexports.toDateTimeString = toDateTimeString;\r\n"],"file":"date-time.js"}